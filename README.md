select * from ( select a.task_id taskId, a.account account, a.deploy_address deployAddress,a.station_code stationCode,   to_char(a.created_date,'DD/MM/yyyy HH24:mi') as createdDateStr ,a.task_name taskName,   a.cus_name cusName,a.telephone telephone,  a.progress taskProgressId,    a.service_type serviceType, a.req_type taskTypeId, b.service_name serviceName, c.task_type_name taskTypeName,   d.task_progress_name taskProgressName, b.service_code serviceCode, a.deadline deadline, a.service_level serviceLevel,a.ACCEPT_TASK_TIME acceptTaskTime,su.username staff,     to_char((a.deadline - SYSDATE)*24,'9999999999999990.9') timeCount,  a.technology technology,gtc.status statusComplaint,  a.IS_GLINE_EXIST isGlineExist ,a.CM_VERSION cmVersion, a.priority priority, s.GROUP_ID departmentId, a.cus_group_type cusGroupType  , a.staff_id staffId, su.ROLE_ID roleId , a.in_project inProject, a.SUB_ORDER_ID subOrderId   from group_task_management a, cat_service b, cat_task_type c, cat_task_progress d,  group_task_assign_management s,cat_department e ,sys_users su,group_task_complaint gtc   where a.req_type = c.task_type_id and a.service_type = b.service_id and a.progress = d.task_progress_id   and a.task_id = s.task_mngt_id  and s.GROUP_ID = e.department_Id  and a.status <> 0 and s.status <> 0   and ((a.new_task = 1 and a.req_type in (1,2,3,29,32,33,48, 60,61,57,63,64,70,71,72,73))  or a.req_type in(9,36,41,1,2,3,29,57,63,64,66,67,68,70,71,72))  and b.service_code <> 'K'  and a.task_id=gtc.task_id (+)   and a.parent_task_id is null   and a.staff_id=su.user_id(+) and LOWER(a.account) like ? escape '\' and e.department_id in (select dep.department_id from cat_department dep where level < 50 start with dep.department_id = ? connect by  prior dep.department_id = dep.parent_id) and a.progress in (1,3,5,6,12,13,14,15,16,17,21,22,24,25,26,27)  order by c.priority asc nulls last  , a.deadline ) where rownum <= ?
